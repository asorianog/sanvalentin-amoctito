<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta property="og:title" content="Holi! ‚ù§Ô∏è" />
  <meta property="og:description" content="Toca para comenzar..." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://asorianog.github.io/sanvalentin-amoctito/" />
  <meta property="og:image" content="https://asorianog.github.io/sanvalentin-amoctito/preview.png" />
  <meta property="og:image:secure_url" content="https://asorianog.github.io/sanvalentin-amoctito/preview.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Pixel font (opcional, pero ayuda a que se vea como tu imagen) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#7a004f;
      --bg2:#ff2d8a;
      --card:#f3e6dc;
      --ink:#3a2a23;
      --muted:#6b4e44;
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius: 28px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif; color:var(--ink); }

    body{
      background:
        radial-gradient(900px 900px at 20% 15%, rgba(255,255,255,.10), transparent 55%),
        radial-gradient(900px 900px at 80% 30%, rgba(255,255,255,.08), transparent 55%),
        linear-gradient(180deg, var(--bg2), var(--bg1));
      overflow:hidden;
    }

    .bg-hearts{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.30;
      filter: blur(.2px);
    }
    .bg-hearts span{
      position:absolute;
      font-size: clamp(18px, 3.5vw, 42px);
      animation: floatUp linear infinite;
      opacity:.55;
      transform: translate3d(0,0,0);
    }
    @keyframes floatUp{
      from{ transform: translateY(110vh) scale(.8); opacity:0; }
      10%{ opacity:.55; }
      to{ transform: translateY(-20vh) scale(1.15); opacity:0; }
    }

    .wrap{
      height:100%;
      display:grid;
      place-items:center;
      padding: 22px;
    }

    .card{
      width:min(720px, 96vw);
      aspect-ratio: 9 / 16;
      max-height: min(92vh, 980px);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      position: relative;
      overflow:hidden;
    }

    .inner{
      position:absolute; inset:0;
      padding: clamp(40px, 6vw, 70px) clamp(18px, 3.8vw, 34px);
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: clamp(10px, 3vw, 22px);
      align-items: center;
    }

    @media (max-width: 520px){
      .inner{
        grid-template-columns: 1fr;
        grid-template-rows: auto 1fr;
        align-items:start;
      }
    }

    .letter{
      margin-top: 50px;
      line-height:1.35;
      font-size: clamp(14px, 2.6vw, 18px);
      color: var(--muted);
      opacity: 0;
      transform: translateX(-14px);
      transition: opacity .7s ease, transform .7s ease;
    }
    .card.stageText .letter{
      opacity: 1;
      transform: translateX(0);
    }
    .letter h1{
      margin:0 0 10px 0;
      font-size: clamp(16px, 3.2vw, 22px);
      color: var(--ink);
      font-weight: 650;
    }

    .type{ min-height: 10lh; white-space: pre-wrap; }
    .cursor{
      display:inline-block;
      width:.6ch;
      animation: blink 1s steps(1) infinite;
      color: var(--ink);
      font-weight:700;
    }
    @keyframes blink{ 50%{ opacity:0; } }

    .treeBox{
      width:100%;
      height:100%;
      display:grid;
      place-items:center;
      position:relative;
    }
    canvas{
      width:100%;
      height:100%;
      max-width: 360px;
      max-height: 520px;
    }

    .ground{
      position:absolute;
      left: 8%;
      right: 8%;
      bottom: clamp(64px, 10vh, 92px);
      height: 2px;
      background: rgba(70,40,30,.5);
      border-radius: 99px;
    }

    .footer{
      position:absolute;
      left: clamp(18px, 3.8vw, 34px);
      right: clamp(18px, 3.8vw, 34px);
      bottom: clamp(16px, 3.2vw, 26px);
      display:flex;
      flex-direction:column;
      gap:6px;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity .7s ease, transform .7s ease;
    }
    .card.stageText .footer{
      opacity: 1;
      transform: translateY(0);
    }
    .footer .label{
      color: var(--muted);
      font-size: clamp(12px, 2.4vw, 15px);
    }
    .timer{
      display:flex;
      gap: clamp(10px, 2.6vw, 18px);
      flex-wrap: wrap;
      font-variant-numeric: tabular-nums;
      color: var(--ink);
      font-size: clamp(16px, 3.6vw, 22px);
      font-weight: 700;
    }
    .timer span small{
      font-weight: 600;
      color: var(--muted);
      font-size: .72em;
      margin-left: 4px;
    }

    /* ‚úÖ NUEVO: infinito brillante para "d√≠as" */
    .timer .inf{
      position: relative;
      display: inline-flex;
      align-items: baseline;
      gap: 4px;
      font-weight: 900;
      letter-spacing: .02em;
      background: linear-gradient(90deg, #ff2d8a, #ffd1e6, #ff2d8a);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      filter: drop-shadow(0 2px 0 rgba(0,0,0,.12));
      animation: shimmer 1.4s linear infinite;
    }
    @keyframes shimmer{
      0%   { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }

    /* corazones cayendo dentro de la tarjeta (solo al final) */
    .fall{
      position:absolute; inset:0;
      pointer-events:none;
      overflow:hidden;
      opacity: 0;
      transition: opacity .5s ease;
    }
    .card.stageText .fall{ opacity: 1; }
    .fall i{
      position:absolute;
      top:-10%;
      font-style:normal;
      animation: fall linear infinite;
      opacity:.75;
      will-change: transform, opacity;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.12));
    }
    @keyframes fall{
      from{ transform: translateY(-10vh) translateX(0) rotate(0deg) scale(.9); opacity:0; }
      10%{ opacity:.75; }
      to{ transform: translateY(120vh) translateX(20px) rotate(240deg) scale(1.1); opacity:0; }
    }

    .mark{
      position:absolute;
      top: 14px;
      left: 18px;
      font-size: 12px;
      color: rgba(0,0,0,.22);
      letter-spacing:.08em;
      text-transform: uppercase;
      user-select:none;
    }

    /* =============================
       INTRO estilo imagen (VALENTINE)
       ============================= */
    .startOverlay{
      position:absolute; inset:0;
      display:grid;
      place-items:center;
      z-index: 50;
      cursor: pointer;
      user-select:none;
      background:
        radial-gradient(900px 800px at 50% 55%, rgba(255,255,255,.08), transparent 55%),
        linear-gradient(180deg, #0a4aa9 0%, #062f7e 70%, #06286b 100%);
    }
    .card.started .startOverlay{
      opacity: 0;
      pointer-events:none;
      transition: opacity .45s ease;
    }

    .introFall{
      position:absolute; inset:0;
      pointer-events:none;
      overflow:hidden;
      opacity: .92;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.22));
    }
    .introFall i{
      position:absolute;
      top:-12%;
      font-style:normal;
      opacity:.9;
      animation: introFall linear infinite;
      will-change: transform, opacity;
    }
    @keyframes introFall{
      0%   { transform: translateY(-12vh) translateX(0) rotate(0deg) scale(.8); opacity:0; }
      12%  { opacity: .95; }
      100% { transform: translateY(120vh) translateX(18px) rotate(240deg) scale(1.05); opacity:0; }
    }

    .introText{
      position:relative;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 14px;
      padding: 18px 18px;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(2px);
      box-shadow: 0 18px 60px rgba(0,0,0,.30);
      text-align:center;
    }

    .valTitle{
      font-family: "Press Start 2P", system-ui, sans-serif;
      font-size: clamp(22px, 5.4vw, 44px);
      letter-spacing: .08em;
      color: #ffb0c9;
      text-transform: uppercase;
      text-shadow:
        0 3px 0 #cc356a,
        0 6px 0 rgba(0,0,0,.28);
    }

    .pressLine{
      font-family: "Press Start 2P", system-ui, sans-serif;
      font-size: clamp(10px, 2.2vw, 13px);
      color: rgba(255,255,255,.88);
      text-shadow: 0 2px 0 rgba(0,0,0,.25);
      opacity: .95;
      animation: pressBlink 1.1s steps(1) infinite;
    }
    @keyframes pressBlink{ 50%{ opacity:.35; } }

    .hintSmall{
      font-size: 12px;
      color: rgba(255,255,255,.78);
      margin-top: -6px;
    }
  </style>
</head>

<body>
  <div class="bg-hearts" aria-hidden="true" id="bg"></div>

  <div class="wrap">
    <div class="card" id="card" role="img" aria-label="Tarjeta rom√°ntica con √°rbol en forma de coraz√≥n">
      <div class="mark">Para ti ‚ù§Ô∏è</div>

      <div class="fall" aria-hidden="true" id="fall"></div>

      <div class="inner">
        <section class="letter">
          <h1>Para mi amorcito preciosaaa:</h1>
          <div class="type" id="type"></div><span class="cursor">|</span>
        </section>

        <section class="treeBox">
          <canvas id="c" width="600" height="900"></canvas>
          <div class="ground"></div>
        </section>
      </div>

      <footer class="footer">
        <div class="label">Mi amor por ti comenz√≥ hace‚Ä¶</div>
        <div class="timer" id="timer"></div>
      </footer>

      <!-- INTRO overlay -->
      <div class="startOverlay" id="start" aria-label="Toca para comenzar">
        <div class="introFall" aria-hidden="true" id="introFall"></div>

        <div class="introText">
          <div class="valTitle">VALENTINE</div>
          <div class="pressLine">Toca la pantalla para comenzar‚Ä¶</div>
          <div class="hintSmall">üíó</div>
        </div>
      </div>

    </div>
  </div>

<script>
/** =========================
 * CONFIG
 * ========================= */
const loveStart = new Date("2025-02-23T00:00:00");
const lines = [
  "Amorcito bella te amo mucho\ny siempre aprecio todo el cari√±o y las cosas que haces por mi.",
  "Valoro mucho nuestra relacion y espero\nte guste este peque√±o detalle :D",
  "Muak muak muchso besitos\nque este sea uno de muchos mas san valentine :D ‚ù§Ô∏è"
];

/** Fondo corazones (atr√°s) */
(function bgHearts(){
  const el = document.getElementById("bg");
  const hearts = ["üíó","üíû","üíñ","üíò","üíì","üíï"];
  const n = 18;
  for(let i=0;i<n;i++){
    const s = document.createElement("span");
    s.textContent = hearts[Math.floor(Math.random()*hearts.length)];
    s.style.left = (Math.random()*100) + "%";
    s.style.animationDuration = (10 + Math.random()*10) + "s";
    s.style.animationDelay = (-Math.random()*18) + "s";
    s.style.opacity = (0.25 + Math.random()*0.4).toFixed(2);
    el.appendChild(s);
  }
})();

/** Intro: corazones cayendo como estrellitas */
(function introFalling(){
  const el = document.getElementById("introFall");
  const hearts = ["üíó","üíñ","üíï","üíò","üíû","üíì"];
  const n = 28;
  for(let i=0;i<n;i++){
    const h = document.createElement("i");
    h.textContent = hearts[Math.floor(Math.random()*hearts.length)];
    h.style.left = (Math.random()*100) + "%";
    h.style.fontSize = (10 + Math.random()*18) + "px";
    h.style.animationDuration = (3.2 + Math.random()*3.6) + "s";
    h.style.animationDelay = (-Math.random()*5.5) + "s";
    h.style.opacity = (0.55 + Math.random()*0.4).toFixed(2);
    el.appendChild(h);
  }
})();

/** Corazones cayendo dentro de la tarjeta (solo al final) */
(function fallingHearts(){
  const el = document.getElementById("fall");
  const hearts = ["üíó","üíû","üíñ","üíò","üíì","üíï"];
  const n = 16;
  for(let i=0;i<n;i++){
    const h = document.createElement("i");
    h.textContent = hearts[Math.floor(Math.random()*hearts.length)];
    h.style.left = (Math.random()*100) + "%";
    h.style.fontSize = (12 + Math.random()*18) + "px";
    h.style.animationDuration = (6 + Math.random()*7) + "s";
    h.style.animationDelay = (-Math.random()*10) + "s";
    el.appendChild(h);
  }
})();

/** Typewriter (se dispara al final) */
function startTypewriter(){
  const out = document.getElementById("type");
  const full = lines.join("\n\n");
  let i = 0;
  const speed = 18;
  function tick(){
    out.textContent = full.slice(0, i++);
    if(i <= full.length) requestAnimationFrame(() => setTimeout(tick, speed));
  }
  tick();
}

/** Timer */
function pad2(n){ return String(n).padStart(2,"0"); }
function renderTimer(){
  const now = new Date();
  const diff = Math.max(0, now - loveStart);

  const sec = Math.floor(diff/1000);
  const days = Math.floor(sec / 86400); // (se calcula, pero ya no se muestra)
  const hours = Math.floor((sec % 86400) / 3600);
  const mins = Math.floor((sec % 3600) / 60);
  const secs = sec % 60;

  document.getElementById("timer").innerHTML = `
    <span class="inf">‚àû<small>d√≠as</small></span>
    <span>${pad2(hours)}<small>horas</small></span>
    <span>${pad2(mins)}<small>minutos</small></span>
    <span>${pad2(secs)}<small>segundos</small></span>
  `;
}
renderTimer();
setInterval(renderTimer, 1000);

/** =========================
 * Canvas: √°rbol coraz√≥n
 * ========================= */
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
const W = canvas.width, H = canvas.height;

function heartPoint(t){
  const x = 16 * Math.pow(Math.sin(t),3);
  const y = 13*Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
  return {x, y};
}

// MISMO formato de coraz√≥n (no lo cambio)
function drawSmallHeart(x,y, r, rot, alpha, color){
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(rot);
  ctx.globalAlpha = alpha;
  ctx.fillStyle = color;
  ctx.beginPath();
  const s = r;
  ctx.moveTo(0, -0.2*s);
  ctx.bezierCurveTo(0.9*s, -1.2*s, 2.2*s, 0.3*s, 0, 1.6*s);
  ctx.bezierCurveTo(-2.2*s, 0.3*s, -0.9*s, -1.2*s, 0, -0.2*s);
  ctx.closePath();
  ctx.fill();
  ctx.restore();
}

function lerp(a,b,t){ return a + (b-a)*t; }
function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }

const leafColors = ["#ff2b68","#ff4d7f","#ff6a92","#ff8cab","#ff1f4d","#ff3b30","#ff567a","#ff7aa7"];
const leaves = [];

function initLeavesMore(){
  leaves.length = 0;

  const cx0 = W*0.55;
  const cy0 = H*0.36;

  const N = 1400;

  for(let i=0;i<N;i++){
    const t = Math.random() * Math.PI * 2;
    const p = heartPoint(t);

    const interior = Math.random() < 0.85;
    const rBias = interior ? Math.pow(Math.random(), 1.6) : (0.80 + Math.random()*0.28);

    const scale = 12 + Math.random()*9.5;

    let x0 = cx0 + (p.x*scale)*rBias;
    let y0 = cy0 - (p.y*scale)*rBias;

    const jitter = interior ? 11 : 16;
    let x = x0 + (Math.random()-0.5)*jitter;
    let y = y0 + (Math.random()-0.5)*jitter;

    leaves.push({
      x, y,
      r: 2.6 + Math.random()*5.9,
      rot: Math.random()*Math.PI*2,
      alpha: 0,
      targetA: 0.56 + Math.random()*0.40,
      color: leafColors[Math.floor(Math.random()*leafColors.length)],
      appearAt: Math.random()*2600,
    });
  }

  const centerBoost = 220;
  for(let i=0;i<centerBoost;i++){
    const t = Math.random() * Math.PI * 2;
    const p = heartPoint(t);
    const rBias = Math.pow(Math.random(), 3.2) * 0.55;

    const scale = 12 + Math.random()*8.5;
    let x = cx0 + (p.x*scale)*rBias + (Math.random()-0.5)*10;
    let y = cy0 - (p.y*scale)*rBias + (Math.random()-0.5)*10;

    leaves.push({
      x, y,
      r: 2.6 + Math.random()*5.4,
      rot: Math.random()*Math.PI*2,
      alpha: 0,
      targetA: 0.62 + Math.random()*0.32,
      color: leafColors[Math.floor(Math.random()*leafColors.length)],
      appearAt: Math.random()*1800,
    });
  }

  leaves.sort((a,b)=>a.appearAt-b.appearAt);
}
initLeavesMore();

let start = performance.now();
let running = true;
let clicked = false;

let drop = null;
let sprout = { progress: 0 };
let treeShift = 0;
let fillProgress = 0;

function drawDroplet(d){
  ctx.save();
  ctx.globalAlpha = d.alpha;
  ctx.fillStyle = "#c11635";
  ctx.translate(d.x, d.y);
  ctx.scale(d.s, d.s);
  ctx.beginPath();
  ctx.moveTo(0, -10);
  ctx.quadraticCurveTo(8, -2, 0, 12);
  ctx.quadraticCurveTo(-8, -2, 0, -10);
  ctx.closePath();
  ctx.fill();
  ctx.restore();
}

function drawTrunk(progress, shift01){
  const baseY = H*0.76;
  const baseX = lerp(W*0.50, W*0.63, shift01);
  const p = clamp(progress,0,1);

  const maxH = 360;
  const h = maxH * p;

  ctx.save();
  ctx.fillStyle = "#8a4a25";

  ctx.beginPath();
  ctx.moveTo(baseX-16, baseY);
  ctx.quadraticCurveTo(baseX-22, baseY-h*0.33, baseX-10, baseY-h*0.72);
  ctx.quadraticCurveTo(baseX-2,  baseY-h*0.86, baseX+18, baseY-h);
  ctx.quadraticCurveTo(baseX+10, baseY-h*0.62, baseX+26, baseY);
  ctx.closePath();
  ctx.fill();

  const br = clamp((p-0.35)/0.65, 0, 1);
  ctx.strokeStyle = "#7a3f1f";
  ctx.lineCap = "round";

  ctx.globalAlpha = 0.9*br;
  ctx.lineWidth = 10;
  ctx.beginPath();
  ctx.moveTo(baseX+2, baseY-h*0.78);
  ctx.quadraticCurveTo(baseX+78, baseY-h*0.90, baseX+112, baseY-h*1.10);
  ctx.stroke();

  ctx.lineWidth = 8;
  ctx.beginPath();
  ctx.moveTo(baseX-2, baseY-h*0.70);
  ctx.quadraticCurveTo(baseX-68, baseY-h*0.82, baseX-98, baseY-h*1.02);
  ctx.stroke();

  ctx.lineWidth = 6;
  ctx.beginPath();
  ctx.moveTo(baseX+22, baseY-h*0.96);
  ctx.quadraticCurveTo(baseX+70, baseY-h*1.05, baseX+90, baseY-h*1.18);
  ctx.stroke();

  ctx.restore();
  return { baseX, baseY, h };
}

let prevNow = performance.now();
function frame(now){
  if(!running) return;
  ctx.clearRect(0,0,W,H);

  if(clicked){
    if(drop){
      drop.vy += 0.0018 * (now - drop.last);
      drop.y += drop.vy * (now - drop.last);
      drop.alpha = Math.max(0, drop.alpha - 0.00055*(now - drop.last));
      drop.last = now;
      drawDroplet(drop);

      const groundY = H*0.72;
      if(drop.y >= groundY || drop.alpha <= 0.01){
        drop = null;
      }
    }

    if(!drop){
      sprout.progress = clamp(sprout.progress + 0.0012*(now - prevNow), 0, 1);

      const shiftTarget = clamp((sprout.progress - 0.25)/0.75, 0, 1);
      treeShift = lerp(treeShift, shiftTarget, 0.06);

      const trunkInfo = drawTrunk(sprout.progress, treeShift);

      const fillTarget = clamp((sprout.progress - 0.32)/0.68, 0, 1);
      fillProgress = Math.max(fillProgress, fillTarget);

      const canopyCx = trunkInfo.baseX + 2;
      const canopyCy = (H*0.36) - trunkInfo.h*0.20;

      const fillTimeMs = 4000;
      const fillMs = fillProgress * fillTimeMs;

      const dx = canopyCx - (W*0.55);
      const dy = canopyCy - (H*0.36);

      for(const leaf of leaves){
        if(leaf.appearAt <= fillMs){
          leaf.alpha = Math.min(leaf.targetA, leaf.alpha + 0.016);
        }
        drawSmallHeart(leaf.x + dx, leaf.y + dy, leaf.r, leaf.rot, leaf.alpha, leaf.color);
      }

      if(sprout.progress > 0.97){
        document.getElementById("card").classList.add("stageText");
      }
    }
  }

  prevNow = now;
  requestAnimationFrame(frame);
}
requestAnimationFrame(frame);

/** Overlay tap */
const cardEl = document.getElementById("card");
const startEl = document.getElementById("start");

function startSequence(){
  if(clicked) return;
  clicked = true;
  cardEl.classList.add("started");

  drop = {
    x: W*0.52,
    y: H*0.22,
    vy: 0.0,
    alpha: 1.0,
    s: 1.0,
    last: performance.now()
  };

  const obs = new MutationObserver(()=>{
    if(cardEl.classList.contains("stageText")){
      obs.disconnect();
      startTypewriter();
    }
  });
  obs.observe(cardEl, {attributes:true});
}

startEl.addEventListener("click", startSequence);
startEl.addEventListener("touchstart", (e)=>{ e.preventDefault(); startSequence(); }, {passive:false});
</script>
</body>
</html>
